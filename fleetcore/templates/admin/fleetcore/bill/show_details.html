{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<h1>Consumptions for: {{ bill }}</h1>

<div class="global-info" style="float: left;">
  <table>
  <tr>
    <th colspan="2" style="background: grey;">The potato</th>
  </tr>
  {% for penalty in penalties %}
  <tr>
    <td>Penalty for plan {{ penalty.plan.name }}</td>
    <td align="right">{{ penalty.minutes }} </td>
  </tr>
  {% endfor %}
  {% if not penalties %}
  <tr>
    <td colspan="2">No penalties</td>
  </tr>
  {% endif %}
  <tr>
    <td>Grand total:</td><td align="right">${{ grand_total|floatformat:2 }} </td>
  </tr>
  <tr>
    <td>Bill debt:</td><td align="right">${{ bill.billing_debt|floatformat:2 }} </td>
  </tr>
  <tr>
    <td></td>
    <td align="right">
    {% if outcome < 0 %}
    <span style="color: red;">
    {% else %}
    <span style="color: green;">
    {% endif %}
    ${{ outcome|floatformat:2 }}
    </span>
    </td>
  </tr>
  </table>
</div>

<div class="leader-info" style="float: right;">
{% for leader, data in leaders.items %}
  <table border="1">
  <tr>
    <th colspan="3">Consumptions for {{ leader.get_full_name }}</th>
  </tr>
  <tr>
    <th>Phone</th> <th>User</th> <th>Total</th>
  </tr>
  {% for c in data.consumptions %}
  <tr>
    <td><a href="/admin/fleetcore/consumption/{{ c.id }}">{{ c.phone.number }}</a></td>
    <td>{{ c.phone.user.get_full_name }}</td>
    <td>$ {{ c.total|floatformat:0 }}</td>
  </tr>
  {% endfor %}
  <tr>
    <td colspan="2" align="right"> Total for {{leader.get_full_name}} </td>
    <td>$ {{ data.total|floatformat:0 }}</td>
  </tr>
  </table>
  </p>
{% endfor %}
</div>

{% endblock %}
