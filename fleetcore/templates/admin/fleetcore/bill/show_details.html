{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<h1>Consumptions for: {{ bill }}</h1>

<div class="float-left">
  <table>
  <thead>
  <tr>
    <th colspan="2">The potato</th>
  </tr>
  </thead>
  <tbody>
  {% for penalty in penalties %}
  <tr>
    <td>Penalty for plan {{ penalty.plan.name }}:</td>
    <td align="right">{{ penalty.minutes }} </td>
  </tr>
  {% endfor %}
  {% if not penalties %}
  <tr>
    <td colspan="2">No penalties</td>
  </tr>
  {% endif %}
  <tr>
    <td>Bill debt:</td><td align="right">${{ bill.billing_debt|floatformat:2 }} </td>
  </tr>
  <tr>
    <td>Grand total:</td><td align="right">${{ bill.consumptions_total|floatformat:2 }} </td>
  </tr>
  </tbody>
  <tfoot>
  <tr>
    <td colspan="2" align="right">
    {% if bill.outcome < 0 %}
    <span style="color: red;">
    {% else %}
    <span style="color: green;">
    {% endif %}
    ${{ bill.outcome|floatformat:2 }}
    </span>
    </td>
  </tr>
  </tfoot>
  </table>
</div>

<div class="float-right">
{% for leader, data in bill.details.items %}
  <table>
  <thead>
  <tr>
    <th colspan="3">Consumptions for {{ leader.get_full_name }}</th>
  </tr>
  <tr>
    <th>Phone</th> <th>User</th> <th>Total</th>
  </tr>
  </thead>
  <tbody>
  {% for c in data.consumptions %}
  <tr class="{% cycle "row1" "row2" %}">
    <td><a href="/admin/fleetcore/consumption/{{ c.id }}">{{ c.phone.number }}</a></td>
    <td>{{ c.phone.user.get_full_name }}</td>
    <td>$ {{ c.total|floatformat:0 }}</td>
  </tr>
  {% endfor %}
  </tbody>
  <tfoot>
  <tr>
    <td colspan="2" align="right"> Total for {{leader.get_full_name}} </td>
    <td>$ {{ data.total|floatformat:0 }}</td>
  </tr>
  </tfoot>
  </table>
  </p>
{% endfor %}
</div>

{% endblock %}
